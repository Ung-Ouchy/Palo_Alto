<!-- Modify it at your will. -->

<decoder name="paloalto_threat">
  <prematch>\d*/\d*/\d* \d*:\d*:\d*,\d*,THREAT,\w*</prematch>
</decoder>

<!-- 2025/08/28 18:06:32,,THREAT,vulnerability,2561,2025/08/28 18:06:32,192.168.0.129,192.168.0.223, -->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex>(\d*/\d*/\d* \d*:\d*:\d*),(\d*),(\w*),(\w*),(\.*),(\.*),(\S*),(\S*),</regex>
  <order>generated_time,unknown1,type,threat_type,unknown2,receive_time,src_ip,dst_ip</order>
</decoder> 

<!-- 192.168.0.129,10.10.9.11,WAN-DMZ,,,web-browsing,vsys1, -->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),</regex>
  <order>nat_src_ip,nat_dst_ip,rule,src_user,dst_user,application,virtual_system</order>
</decoder>

<!-- WAN,DMZ,ethernet1/1,ethernet1/3,palo-wazuh,2025/08/28 18:06:32,2108, -->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),</regex>
  <order>src_zone,dst_zone,src_interface,dst_interface,log_actiont,generated_time,session_id</order>
</decoder>

<!-- 1,51214,80,51214,80,0x402000,tcp,alert,,HTTP /etc/shadow access attempt(35090) -->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),</regex>
  <order>repeat_count,src_port,dst_port,nat_src_port,nat_dst_port,unknown3,ip_protocol,action,file_name,threat_name</order>
</decoder>

<!-- any,high,client-to-server,7543795788371984388,0x0,192.168.0.0-192.168.255.255,192.168.0.0-192.168.255.255,, -->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),</regex>
  <order>category,serverity,flags,unknown4,unknown5,src_country,dst_country,unknown6</order>
</decoder>

<!-- ,0,,,1,, -->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),</regex>
  <order>unknown7,unknown8,unknown9,unknown10,unknown11,unknown12</order>
</decoder>

<!-- ,,,, -->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),</regex>
  <order>unknown13,unknown14,unknown15,unknown16</order>
</decoder>

<!-- ,,0,0, -->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),</regex>
  <order>unknown17,unknown18,unknown19,unknown20</order>
</decoder>

<!-- 0,0,0,,PA-VM,, -->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),</regex>
  <order>unknown21,unknown22,unknown23,unknown24,device_name,unknown25</order>
</decoder>

<!-- ,,,0, -->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),</regex>
  <order>unknown26,unknown27,unknown28,unknown29</order>
</decoder>

<!-- ,0,,N/A,info-leak,AppThreat-8402-6681,-->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),</regex>
  <order>unknown30,unknown31,unknown32,tunnel_type,detail_category,content_version</order>
</decoder>

<!-- 0x2,0,4294967295,,,b3e8cd6c-6495-49a2-8bbe-4c1a771bcd2f,-->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),</regex>
  <order>unknown33,unknown34,unknown35,unknown36,unknown37,rule_uuid</order>
</decoder>

<!-- 0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0,2025-08-28T17:42:16.827-07:00, -->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),</regex>
  <order>unknown38,unknown39,unknown40,unknown41,unknown42,unknown43,unknown44,unknown45,unknown46,unknown47,unknown48,unknown49,unknown50,unknown51,unknown52,unknown53,unknown54,unknown55,unknown56,unknown57,unknown58,unknown59,unknown60,unknown61,unknown62,unknown63,unknown64,unknown65,unknown66,unknown67,time</order>
</decoder>

<!-- ,,,internet-utility,general-internet,browser-based,4,"used-by-malware,able-to-transfer-file,has-known-vulnerability,tunnel-other-application,pervasive-use",,web-browsing,no,no -->
<decoder name="paloalto_threat_fields">
  <parent>paloalto_threat</parent>
  <regex offset="after_regex">(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*),(\.*)</regex>
  <order>unknown68,unknown69,unknown70,app_category,app_subcategory,app_technology,app_risk,app_characteristics</order>
</decoder>
